<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Satƒ±n Alma Paneli - Glohe Portal</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/purchasing.css">
    <link rel="stylesheet" href="styles/purchasing_dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0d1b2a">
</head>
<body>
    <div class="app-container">
        <!-- App Header -->
        <header class="app-header">
            <h1 id="header-title">Panel</h1>
            <button id="logout-button">√áƒ±kƒ±≈ü</button>
        </header>

        <!-- App Main Content -->
        <main class="app-main">
            <!-- Dashboard/Panel View -->
            <div id="view-dashboard" class="app-view active">
                <div class="purchasing-stats-grid">
                    <!-- Toplam Sipari≈ü -->
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #e3f2fd;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#1976d2" stroke-width="2">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Toplam Sipari≈ü</div>
                            <div class="stat-value" id="kpi-total-orders">--</div>
                        </div>
                    </div>

                    <!-- A√ßƒ±k ve Kƒ±smi Sipari≈üler -->
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #fff3e0;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f57c00" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">A√ßƒ±k ve Kƒ±smi Sipari≈üler</div>
                            <div class="stat-value" style="display: flex; align-items: center; gap: 8px; font-size: 20px; flex-wrap: wrap;">
                                <span style="color: #f57c00;">A√ßƒ±k: <span id="kpi-open-orders">--</span></span>
                                <span style="color: #999;">|</span>
                                <span style="color: #ff9800;">Kƒ±smi: <span id="kpi-partial-orders">--</span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Toplam Tutar -->
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #e8f5e9;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#2e7d32" stroke-width="2">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Toplam Tutar (TL)</div>
                            <div class="stat-value" id="kpi-total-amount">--</div>
                        </div>
                    </div>

                    <!-- Ortalama Termin Farkƒ± -->
                    <div class="stat-card">
                        <div class="stat-icon" id="kpi-delivery-icon" style="background: #fff3e0;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f57c00" stroke-width="2">
                                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Ort. Termin Farkƒ±</div>
                            <div class="stat-value" id="kpi-avg-delivery">--</div>
                        </div>
                    </div>
                </div>

                <section class="chart-container">
                    <h2>Haftalƒ±k Sipari≈ü √ñzeti</h2>
                    <canvas id="weekly-orders-chart"></canvas>
                </section>
            </div>

            <!-- Orders View -->
            <div id="view-orders" class="app-view">
                <div class="view-header">
                    <h2>Sipari≈ü Raporu</h2>
                </div>

                <!-- Hƒ±zlƒ± Arama -->
                <div class="quick-search-container">
                    <input
                        type="text"
                        id="quick-search-orders"
                        class="quick-search-input"
                        placeholder="üîç Sipari≈ü No, Tedarik√ßi, Malzeme ara..."
                        oninput="quickSearchOrders(this.value)"
                    />
                    <button id="advanced-filter-button" class="icon-button-small" onclick="openAdvancedFilter()">
                        <span>‚öôÔ∏è Geli≈ümi≈ü Filtre</span>
                    </button>
                </div>

                <!-- Sipari≈ü Listesi -->
                <div id="orders-list">
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                </div>
            </div>

            <!-- Revision Analysis View -->
            <div id="view-revision-analytics" class="app-view">
                <div class="view-header">
                    <h2>Revizyon Analizi</h2>
                </div>

                <!-- Hƒ±zlƒ± Arama -->
                <div class="quick-search-container">
                    <input
                        type="text"
                        id="quick-search-revision"
                        class="quick-search-input"
                        placeholder="üîç Malzeme ara..."
                        oninput="quickSearchRevision(this.value)"
                    />
                </div>

                <!-- Revizyon ƒ∞√ßerik -->
                <div id="revision-analytics-content">
                    <p>Revizyon analizi verileri buraya y√ºklenecek.</p>
                </div>
            </div>
        </main>

        <!-- Floating Action Button REMOVED -->

        <!-- Bottom Navigation -->
        <nav class="app-nav">
            <button class="nav-item active" data-view="dashboard">
                <span class="icon">üìä</span>
                <span class="label">√ñzet</span>
            </button>
            <button class="nav-item" data-view="orders">
                <span class="icon">üì¶</span>
                <span class="label">Sipari≈ü Raporu</span>
            </button>
            <button class="nav-item" data-view="revision-analytics">
                <span class="icon">üîÑ</span>
                <span class="label">Revizyon Analiz</span>
            </button>
        </nav>
    </div>

    <script type="module" src="scripts/purchasing_dashboard.js"></script>
    <script type="module" src="scripts/revision-analytics.js"></script>

    <!-- Filter Modal -->
    <div id="filter-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Filtrele & Sƒ±rala</h2>
                <button id="close-filter-modal" class="icon-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="filter-group">
                    <label for="filter-search">Genel Arama</label>
                    <input type="text" id="filter-search" placeholder="Sipari≈ü No, Tedarik√ßi, Malzeme...">
                </div>
                <div class="filter-group">
                    <label for="filter-status">Teslimat Durumu</label>
                    <select id="filter-status">
                        <option value="">T√ºm√º</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-supplier">Tedarik√ßi</label>
                    <select id="filter-supplier">
                        <option value="">T√ºm√º</option>
                    </select>
                </div>
                 <div class="filter-group">
                    <label for="filter-start-date">Ba≈ülangƒ±√ß Tarihi</label>
                    <input type="date" id="filter-start-date">
                </div>
                 <div class="filter-group">
                    <label for="filter-end-date">Biti≈ü Tarihi</label>
                    <input type="date" id="filter-end-date">
                </div>
            </div>
            <div class="modal-footer">
                <button id="reset-filters-button" class="btn-secondary">Filtreleri Temizle</button>
                <button id="apply-filters-button" class="btn-primary">Uygula</button>
            </div>
        </div>
    </div>
</body>
</html>
