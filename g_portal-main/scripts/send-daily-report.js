const { createClient } = require('@supabase/supabase-js')

async function sendDailyReport() {
  try {
    console.log('üìä Detaylƒ± g√ºnl√ºk rapor g√∂nderimi ba≈ülƒ±yor...')

    // Supabase client
    const supabase = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_ROLE_KEY
    )

    // T√ºm verileri √ßek
    const { data: measurements, error } = await supabase
      .from('measurements')
      .select('id, category, point, value, unit, date, time, user, note')
      .order('id', { ascending: false })
      .limit(1000)

    if (error) throw error
    if (!measurements || measurements.length === 0) {
      throw new Error('Veritabanƒ±nda hi√ß √∂l√ß√ºm verisi bulunamadƒ±.')
    }

    console.log(`‚úÖ ${measurements.length} √∂l√ß√ºm verisi √ßekildi`)

    // Tarih hesaplamalarƒ± (Turkish Time - UTC+3)
    const nowTR = new Date()
    nowTR.setHours(nowTR.getHours() + 3)
    const today = nowTR.toISOString().split('T')[0]
    const currentTime = `${String(nowTR.getHours()).padStart(2, '0')}:${String(nowTR.getMinutes()).padStart(2, '0')}`

    // Bug√ºnk√º t√ºm √∂l√ß√ºmler
    const todayMeasurements = measurements.filter(m => m.date === today)

    // Aylƒ±k √∂l√ß√ºmler (bu ay)
    const currentMonth = today.substring(0, 7) // YYYY-MM
    const monthlyMeasurements = measurements.filter(m => m.date && m.date.startsWith(currentMonth))

    // Son 30 g√ºn
    const thirtyDaysAgo = new Date(nowTR.getTime() - 30 * 24 * 60 * 60 * 1000)
    thirtyDaysAgo.setHours(thirtyDaysAgo.getHours() + 3)
    const thirtyDaysAgoDate = thirtyDaysAgo.toISOString().split('T')[0]
    const last30DaysMeasurements = measurements.filter(m => m.date >= thirtyDaysAgoDate)

    console.log(`üìÖ Bug√ºn: ${todayMeasurements.length} √∂l√ß√ºm`)
    console.log(`üìÜ Bu Ay: ${monthlyMeasurements.length} √∂l√ß√ºm`)
    console.log(`üìä Son 30 G√ºn: ${last30DaysMeasurements.length} √∂l√ß√ºm`)

    // Rapor tarihi
    const reportDate = nowTR.toLocaleDateString('tr-TR', {
      day: 'numeric',
      month: 'long',
      year: 'numeric'
    })

    // 1. BUG√úNK√ú KATEGORƒ∞ ANALƒ∞Zƒ∞
    const categoryAnalysis = {}
    const categoryPoints = {}
    todayMeasurements.forEach(m => {
      const cat = m.category || 'Diƒüer'
      const point = m.point || 'Bilinmeyen'

      if (!categoryAnalysis[cat]) {
        categoryAnalysis[cat] = 0
        categoryPoints[cat] = new Set()
      }
      categoryAnalysis[cat]++
      categoryPoints[cat].add(point)
    })

    // Kategori ikonlarƒ±
    const categoryIcons = {
      'ph': '‚öóÔ∏è',
      'klor': 'üß™',
      'sƒ±caklƒ±k': 'üå°Ô∏è',
      'bulanƒ±klƒ±k': 'üíß',
      'oksijen': 'ü´ß',
      'iletkenlik': '‚ö°',
      'diƒüer': 'üìä'
    }

    const todayCategories = Object.entries(categoryAnalysis)
      .sort((a, b) => b[1] - a[1])
      .map(([name, count]) => {
        const icon = categoryIcons[name.toLowerCase()] || 'üìä'
        const pointCount = categoryPoints[name].size
        return `
        <tr>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb;">
            <span style="font-size: 20px; margin-right: 8px;">${icon}</span>
            <span style="color: #374151; font-size: 14px; font-weight: 600;">
              ${name.charAt(0).toUpperCase() + name.slice(1)}
            </span>
          </td>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb; text-align: center;">
            <span style="color: #059669; font-weight: 700; font-size: 16px;">
              ${count}
            </span>
            <span style="color: #6b7280; font-size: 12px; margin-left: 4px;">√∂l√ß√ºm</span>
          </td>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb; text-align: center;">
            <span style="color: #0891b2; font-weight: 700; font-size: 16px;">
              ${pointCount}
            </span>
            <span style="color: #6b7280; font-size: 12px; margin-left: 4px;">nokta</span>
          </td>
        </tr>
        `
      }).join('')

    // 2. BUG√úN KONTROL EDƒ∞LEN NOKTALAR
    const todayPoints = {}
    todayMeasurements.forEach(m => {
      const point = m.point || 'Bilinmeyen'
      todayPoints[point] = (todayPoints[point] || 0) + 1
    })

    const todayTopPoints = Object.entries(todayPoints)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 10)
      .map(([point, count], index) => `
        <tr>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb;">
            <span style="display: inline-block; width: 24px; height: 24px; background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); border-radius: 50%; text-align: center; line-height: 24px; font-size: 12px; font-weight: 700; color: #059669; margin-right: 8px;">
              ${index + 1}
            </span>
            <span style="color: #374151; font-size: 14px; font-weight: 600;">
              ${point}
            </span>
          </td>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb; text-align: right;">
            <span style="color: #059669; font-weight: 700; font-size: 16px;">
              ${count}
            </span>
            <span style="color: #6b7280; font-size: 12px; margin-left: 4px;">kez</span>
          </td>
        </tr>
      `).join('')

    // 3. BUG√úNK√ú KULLANICI PERFORMANSI
    const userPerformance = {}
    const userCategories = {}
    todayMeasurements.forEach(m => {
      const user = m.user || 'Bilinmeyen'
      const cat = m.category || 'Diƒüer'

      if (!userPerformance[user]) {
        userPerformance[user] = 0
        userCategories[user] = new Set()
      }
      userPerformance[user]++
      userCategories[user].add(cat)
    })

    const sortedUsers = Object.entries(userPerformance)
      .sort((a, b) => b[1] - a[1])

    const topUser = sortedUsers.length > 0 ? sortedUsers[0][0] : null

    const userPerformanceList = sortedUsers.map(([user, count]) => {
      const categoryCount = userCategories[user].size
      const isTop = user === topUser
      return `
        <tr>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb;">
            <span style="color: #374151; font-size: 14px; font-weight: 600;">
              ${user}
            </span>
            ${isTop ? '<span style="margin-left: 8px; font-size: 16px;">üèÜ</span>' : ''}
          </td>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb; text-align: center;">
            <span style="color: #059669; font-weight: 700; font-size: 16px;">
              ${count}
            </span>
            <span style="color: #6b7280; font-size: 12px; margin-left: 4px;">√∂l√ß√ºm</span>
          </td>
          <td style="padding: 12px 10px; border-bottom: 1px solid #e5e7eb; text-align: center;">
            <span style="color: #0891b2; font-weight: 700; font-size: 16px;">
              ${categoryCount}
            </span>
            <span style="color: #6b7280; font-size: 12px; margin-left: 4px;">kategori</span>
          </td>
        </tr>
      `
    }).join('')

    // 4. EN √áOK KONTROL EDƒ∞LEN NOKTALAR (T√úM ZAMANLAR)
    const allTimePoints = {}
    measurements.forEach(m => {
      const point = m.point || 'Bilinmeyen'
      allTimePoints[point] = (allTimePoints[point] || 0) + 1
    })

    const rankBadges = ['ü•á', 'ü•à', 'ü•â', '4Ô∏è‚É£', '5Ô∏è‚É£']
    const topAllTimePoints = Object.entries(allTimePoints)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5)
      .map(([point, count], index) => `
        <tr>
          <td style="padding: 14px 10px; border-bottom: 1px solid #e5e7eb;">
            <span style="font-size: 24px; margin-right: 8px;">
              ${rankBadges[index]}
            </span>
            <span style="color: #111827; font-size: 15px; font-weight: 700;">
              ${point}
            </span>
          </td>
          <td style="padding: 14px 10px; border-bottom: 1px solid #e5e7eb; text-align: right;">
            <span style="color: #059669; font-weight: 800; font-size: 18px;">
              ${count}
            </span>
            <span style="color: #6b7280; font-size: 12px; margin-left: 4px;">toplam</span>
          </td>
        </tr>
      `).join('')

    // 5. SON 10 AKTƒ∞Vƒ∞TE
    const recentActivities = measurements.slice(0, 10).map(m => `
      <tr>
        <td style="padding: 10px; border-bottom: 1px solid #e5e7eb;">
          <div style="color: #6b7280; font-size: 12px;">
            ${m.date || 'N/A'}
          </div>
          <div style="color: #374151; font-size: 13px; font-weight: 600; margin-top: 2px;">
            ${m.time || 'N/A'}
          </div>
        </td>
        <td style="padding: 10px; border-bottom: 1px solid #e5e7eb;">
          <span style="background: #ecfdf5; color: #059669; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">
            ${(m.category || 'N/A').charAt(0).toUpperCase() + (m.category || 'N/A').slice(1)}
          </span>
        </td>
        <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; color: #374151; font-size: 13px;">
          ${m.point || 'N/A'}
        </td>
        <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; text-align: center;">
          <span style="color: #059669; font-weight: 700; font-size: 14px;">
            ${m.value || 'N/A'}
          </span>
          <span style="color: #6b7280; font-size: 11px; margin-left: 2px;">
            ${m.unit || ''}
          </span>
        </td>
        <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; color: #6b7280; font-size: 12px;">
          ${m.user || 'N/A'}
        </td>
      </tr>
    `).join('')

    // 30 g√ºnl√ºk ortalama hesaplama
    const avgLast30Days = last30DaysMeasurements.length > 0
      ? Math.round(last30DaysMeasurements.length / 30)
      : 0

    const htmlContent = `
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detaylƒ± Su Kalitesi Raporu</title>
  <!--[if mso]>
  <style type="text/css">
    table {border-collapse: collapse; border-spacing: 0;}
    .outlook-group-fix {width: 100% !important;}
  </style>
  <![endif]-->
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background-color: #f3f4f6;">
  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background-color: #f3f4f6; padding: 20px 0;">
    <tr>
      <td align="center">
        <!-- Main Container -->
        <table role="presentation" width="600" cellpadding="0" cellspacing="0" style="background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">

          <!-- Header -->
          <tr>
            <td style="background: linear-gradient(135deg, #059669 0%, #0891b2 100%); padding: 40px 40px; text-align: center;">
              <h1 style="margin: 0; color: #ffffff; font-size: 26px; font-weight: 800; letter-spacing: -0.5px;">
                üìä GLOHE PORTAL ‚Ä¢ Detaylƒ± Rapor
              </h1>
              <p style="margin: 14px 0 0 0; color: #ffffff; font-size: 16px; font-weight: 500; opacity: 0.95; letter-spacing: 0.3px;">
                ${reportDate} ‚Ä¢ ${currentTime}
              </p>
            </td>
          </tr>

          <!-- KPI Cards -->
          <tr>
            <td style="padding: 30px 40px 20px 40px;">
              <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                <tr>
                  <!-- Today Card -->
                  <td width="32%" style="background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); border-radius: 8px; padding: 20px; border-left: 4px solid #10b981;">
                    <p style="margin: 0 0 8px 0; font-size: 10px; font-weight: 700; color: #065f46; text-transform: uppercase; letter-spacing: 0.5px;">
                      BUG√úN
                    </p>
                    <p style="margin: 0; font-size: 32px; font-weight: 900; color: #047857; line-height: 1;">
                      ${todayMeasurements.length}
                    </p>
                    <p style="margin: 6px 0 0 0; font-size: 11px; color: #059669; font-weight: 600;">
                      √ñl√ß√ºm
                    </p>
                  </td>
                  <td width="2%"></td>
                  <!-- Monthly Card -->
                  <td width="32%" style="background: linear-gradient(135deg, #cffafe 0%, #a5f3fc 100%); border-radius: 8px; padding: 20px; border-left: 4px solid #0891b2;">
                    <p style="margin: 0 0 8px 0; font-size: 10px; font-weight: 700; color: #164e63; text-transform: uppercase; letter-spacing: 0.5px;">
                      BU AY
                    </p>
                    <p style="margin: 0; font-size: 32px; font-weight: 900; color: #155e75; line-height: 1;">
                      ${monthlyMeasurements.length}
                    </p>
                    <p style="margin: 6px 0 0 0; font-size: 11px; color: #0891b2; font-weight: 600;">
                      √ñl√ß√ºm
                    </p>
                  </td>
                  <td width="2%"></td>
                  <!-- Average Card -->
                  <td width="32%" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 8px; padding: 20px; border-left: 4px solid #f59e0b;">
                    <p style="margin: 0 0 8px 0; font-size: 10px; font-weight: 700; color: #78350f; text-transform: uppercase; letter-spacing: 0.5px;">
                      ORT. (30 G√úN)
                    </p>
                    <p style="margin: 0; font-size: 32px; font-weight: 900; color: #b45309; line-height: 1;">
                      ${avgLast30Days}
                    </p>
                    <p style="margin: 6px 0 0 0; font-size: 11px; color: #d97706; font-weight: 600;">
                      /g√ºn
                    </p>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- Category Analysis -->
          ${todayCategories.length > 0 ? `
          <tr>
            <td style="padding: 20px 40px;">
              <h2 style="margin: 0 0 16px 0; font-size: 17px; font-weight: 700; color: #111827;">
                üìä Bug√ºnk√º Kategori Analizi
              </h2>
              <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                <tr style="background: #f9fafb;">
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kategori
                  </th>
                  <th style="padding: 12px 10px; text-align: center; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    √ñl√ß√ºm Sayƒ±sƒ±
                  </th>
                  <th style="padding: 12px 10px; text-align: center; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Nokta Sayƒ±sƒ±
                  </th>
                </tr>
                ${todayCategories}
              </table>
            </td>
          </tr>
          ` : ''}

          <!-- Today's Top Points -->
          ${todayTopPoints.length > 0 ? `
          <tr>
            <td style="padding: 20px 40px;">
              <h2 style="margin: 0 0 16px 0; font-size: 17px; font-weight: 700; color: #111827;">
                üìç Bug√ºn Kontrol Edilen Noktalar
              </h2>
              <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                <tr style="background: #f9fafb;">
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kontrol Noktasƒ±
                  </th>
                  <th style="padding: 12px 10px; text-align: right; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kontrol Sayƒ±sƒ±
                  </th>
                </tr>
                ${todayTopPoints}
              </table>
            </td>
          </tr>
          ` : ''}

          <!-- User Performance -->
          ${userPerformanceList.length > 0 ? `
          <tr>
            <td style="padding: 20px 40px;">
              <h2 style="margin: 0 0 16px 0; font-size: 17px; font-weight: 700; color: #111827;">
                üë• Bug√ºnk√º Kullanƒ±cƒ± Performansƒ±
              </h2>
              <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                <tr style="background: #f9fafb;">
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kullanƒ±cƒ±
                  </th>
                  <th style="padding: 12px 10px; text-align: center; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    √ñl√ß√ºm Sayƒ±sƒ±
                  </th>
                  <th style="padding: 12px 10px; text-align: center; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kategori √áe≈üitliliƒüi
                  </th>
                </tr>
                ${userPerformanceList}
              </table>
            </td>
          </tr>
          ` : ''}

          <!-- All-Time Top Points -->
          ${topAllTimePoints.length > 0 ? `
          <tr>
            <td style="padding: 20px 40px;">
              <h2 style="margin: 0 0 16px 0; font-size: 17px; font-weight: 700; color: #111827;">
                üèÖ En √áok Kontrol Edilen Noktalar (T√ºm Zamanlar)
              </h2>
              <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border: 2px solid #f59e0b; border-radius: 8px; overflow: hidden;">
                ${topAllTimePoints}
              </table>
            </td>
          </tr>
          ` : ''}

          <!-- Recent Activities -->
          ${recentActivities.length > 0 ? `
          <tr>
            <td style="padding: 20px 40px 30px 40px;">
              <h2 style="margin: 0 0 16px 0; font-size: 17px; font-weight: 700; color: #111827;">
                üïê Son 10 Aktivite
              </h2>
              <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                <tr style="background: #f9fafb;">
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Tarih/Saat
                  </th>
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kategori
                  </th>
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Nokta
                  </th>
                  <th style="padding: 12px 10px; text-align: center; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Deƒüer
                  </th>
                  <th style="padding: 12px 10px; text-align: left; font-size: 11px; font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid #e5e7eb;">
                    Kullanƒ±cƒ±
                  </th>
                </tr>
                ${recentActivities}
              </table>
            </td>
          </tr>
          ` : ''}

          <!-- No Data Warning -->
          ${todayMeasurements.length === 0 ? `
          <tr>
            <td style="padding: 20px 40px;">
              <div style="background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 8px; padding: 20px; text-align: center;">
                <p style="margin: 0; color: #92400e; font-size: 14px; font-weight: 600;">
                  ‚ö†Ô∏è Bug√ºn hen√ºz √∂l√ß√ºm kaydƒ± bulunmuyor
                </p>
              </div>
            </td>
          </tr>
          ` : ''}

          <!-- Footer -->
          <tr>
            <td style="padding: 30px 40px; text-align: center; border-top: 1px solid #e5e7eb;">
              <p style="margin: 0; color: #059669; font-size: 13px; font-weight: 700;">
                üíß GLOHE PORTAL
              </p>
              <p style="margin: 8px 0 0 0; color: #9ca3af; font-size: 12px;">
                ¬© ${new Date().getFullYear()} Su Kalitesi Kontrol Sistemi
              </p>
              <p style="margin: 8px 0 0 0; color: #d1d5db; font-size: 11px;">
                Detaylƒ± g√ºnl√ºk rapor ‚Ä¢ Her g√ºn otomatik olarak g√∂nderilir
              </p>
            </td>
          </tr>

        </table>
      </td>
    </tr>
  </table>
</body>
</html>
    `

    // Resend ile mail g√∂nder
    console.log('üìß Email g√∂nderiliyor...')

    const emailResponse = await fetch('https://api.resend.com/emails', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${process.env.RESEND_API_KEY}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        from: 'Glohe Portal <onboarding@resend.dev>',
        to: [process.env.RECIPIENT_EMAIL],
        subject: `üìä GLOHE PORTAL ‚Ä¢ Detaylƒ± Su Kalitesi Raporu - ${reportDate} ${currentTime}`,
        html: htmlContent,
      }),
    })

    const emailResult = await emailResponse.json()

    if (!emailResponse.ok) {
      console.error('‚ùå Email g√∂nderimi ba≈üarƒ±sƒ±z:', emailResult)
      throw new Error(`Email g√∂nderimi ba≈üarƒ±sƒ±z: ${JSON.stringify(emailResult)}`)
    }

    console.log('‚úÖ Email ba≈üarƒ±yla g√∂nderildi!')
    console.log(`üì¨ Email ID: ${emailResult.id}`)
    console.log(`üì® Alƒ±cƒ±: ${process.env.RECIPIENT_EMAIL}`)
    console.log(`üìä Bug√ºnk√º √∂l√ß√ºm: ${todayMeasurements.length}`)
    console.log(`üìÜ Aylƒ±k √∂l√ß√ºm: ${monthlyMeasurements.length}`)
    console.log(`üìà 30 g√ºnl√ºk ortalama: ${avgLast30Days}/g√ºn`)

    process.exit(0)

  } catch (error) {
    console.error('‚ùå Hata:', error.message)
    process.exit(1)
  }
}

// √áalƒ±≈ütƒ±r
sendDailyReport()
